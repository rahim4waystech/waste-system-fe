import { Component, OnInit } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { NgxChartsModule } from '@swimlane/ngx-charts';
import * as moment from 'moment';
import { User } from 'src/app/auth/models/user.model';
import { AuthService } from 'src/app/auth/services/auth.service';
import { DashboardService } from '../../services/dashboard.service';
import { catchError, take } from 'rxjs/operators';
import { DashboardStateServiceService } from '../../services/dashboard-state-service.service';
import { UploadService } from 'src/app/core/services/upload.service';
import { EnvironmentService } from 'src/app/settings/services/environment.service';


@Component({
  selector: 'app-home',
  templateUrl: './home.component.html',
  styleUrls: ['./home.component.scss']
})
export class HomeComponent implements OnInit {
  user: User = new User();
  dashboard:any = {};
  dashItems: any = [];

  startDate = moment().subtract(1,'w').format('YYYY-MM-DD');
  endDate = moment().format('YYYY-MM-DD');

  logo:string = 'data:image/png;base64,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';
  constructor(
    private authService:AuthService,
    private uploadService: UploadService,
    private environmentService: EnvironmentService,
    private dashService: DashboardService,
    private dashboardStateService: DashboardStateServiceService
  ) { }

  ngOnInit(): void {
    this.user = this.authService.getUser();

    // this.uploadService.uploadAppFile({filedata: '', mimetype: '', originalname: ''}, 'hjjj', 1)
    // .pipe(take(1))
    // .pipe(catchError((e) => {
    //   alert('Cannot upload file');
    //   return e;
    // }))
    // .subscribe((data) => {
    // })

    this.dashService.getActiveDashboardByUserId(this.user.id)
    .pipe(catchError((e)=>{if(e.status === 403 || e.status === 401){return e;}
    alert('Could not retrieve Dashboard Settings');return e;}))
    .pipe(take(1))
    .subscribe(dash => {
      this.dashboard = dash[0];

      if(this.dashboard !== undefined){
        if(this.dashboard.slotId1 !== null && this.dashboard.slotId1 !== undefined){this.dashItems.push(this.dashboard.slotId1);}
        if(this.dashboard.slotId2 !== null && this.dashboard.slotId2 !== undefined){this.dashItems.push(this.dashboard.slotId2);}
        if(this.dashboard.slotId3 !== null && this.dashboard.slotId3 !== undefined){this.dashItems.push(this.dashboard.slotId3);}
        if(this.dashboard.slotId4 !== null && this.dashboard.slotId4 !== undefined){this.dashItems.push(this.dashboard.slotId4);}
        if(this.dashboard.slotId5 !== null && this.dashboard.slotId5 !== undefined){this.dashItems.push(this.dashboard.slotId5);}
        if(this.dashboard.slotId6 !== null && this.dashboard.slotId6 !== undefined){this.dashItems.push(this.dashboard.slotId6);}
      }
    })
  }

  updateDate(){
    // this.dashboardStateService.$startDateUpdated.next(this.startDate);
    // this.dashboardStateService.$endDateUpdated.next(this.endDate);
    this.dashboardStateService.$datesChanged.next(0);
  }

}
